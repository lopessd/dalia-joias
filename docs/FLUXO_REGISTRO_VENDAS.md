# Fluxo de Registro de Vendas de MostruÃ¡rio

## ğŸ“Š Diagrama de Fluxo

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    PÃGINA DE MOSTRUÃRIOS (Admin)                 â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚ MostruÃ¡rio 1 â”‚  â”‚ MostruÃ¡rio 2 â”‚  â”‚ MostruÃ¡rio 3 â”‚          â”‚
â”‚  â”‚  Entregue    â”‚  â”‚  Finalizado  â”‚  â”‚  Entregue    â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚         â”‚                  â”‚                                      â”‚
â”‚         â–¼                  â–¼                                      â”‚
â”‚    [Finalizar]      [Ver Detalhes]                              â”‚
â”‚                     [Registrar Venta] â—„â”€â”€ Nova opÃ§Ã£o            â”‚
â”‚                     [Exportar PDF]                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚                           â”‚
                â–¼                           â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ FINALIZAR MOSTRUÃRIO  â”‚   â”‚ REGISTRAR VENDA       â”‚
    â”‚                       â”‚   â”‚   (Manual)            â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚ 1. Inserir devoluÃ§Ãµes â”‚   â”‚ 1. Abrir modal        â”‚
    â”‚ 2. Calcular vendidos  â”‚   â”‚ 2. Configurar venda   â”‚
    â”‚ 3. Confirmar          â”‚   â”‚ 3. Registrar          â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â”‚ Tem produtos vendidos?
                â”‚
                â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚     SIM     â”‚
         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â”‚ Abre automaticamente
                â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  MODAL: REGISTRAR VENTA        â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚                                â”‚
    â”‚  ğŸ“‹ InformaÃ§Ãµes do MostruÃ¡rio  â”‚
    â”‚  - Distribuidor                â”‚
    â”‚  - CÃ³digo                      â”‚
    â”‚  - Produtos vendidos           â”‚
    â”‚                                â”‚
    â”‚  ğŸšï¸ Controle de ComissÃ£o       â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
    â”‚  â”‚ [ ] ComissÃ£o Global      â”‚  â”‚
    â”‚  â”‚                          â”‚  â”‚
    â”‚  â”‚ Porcentaje: [15%]        â”‚  â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
    â”‚                                â”‚
    â”‚  ğŸ“¦ Lista de Produtos          â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
    â”‚  â”‚ Produto A                â”‚  â”‚
    â”‚  â”‚ Vendido: 3x Ã— â‚²10.000    â”‚  â”‚
    â”‚  â”‚ ComisiÃ³n: [15%] â‚²4.500   â”‚  â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
    â”‚  â”‚ Produto B                â”‚  â”‚
    â”‚  â”‚ Vendido: 2x Ã— â‚²5.000     â”‚  â”‚
    â”‚  â”‚ ComisiÃ³n: [15%] â‚²1.500   â”‚  â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
    â”‚                                â”‚
    â”‚  ğŸ“ DescripciÃ³n (opcional)     â”‚
    â”‚  [Venda do mostruÃ¡rio...]      â”‚
    â”‚                                â”‚
    â”‚  ğŸ’° RESUMO                     â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
    â”‚  â”‚ Productos: 5 piezas      â”‚  â”‚
    â”‚  â”‚ Valor Total: â‚²40.000     â”‚  â”‚
    â”‚  â”‚ ComisiÃ³n: â‚²6.000         â”‚  â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
    â”‚                                â”‚
    â”‚  [Cancelar] [Registrar Venta] â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â”‚ Confirmar
                 â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   SALVAR NO BANCO DE DADOS     â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚                                â”‚
    â”‚  1ï¸âƒ£ Criar registro em 'sales'  â”‚
    â”‚     - showcase_id              â”‚
    â”‚     - profile_id               â”‚
    â”‚     - total_value              â”‚
    â”‚     - description              â”‚
    â”‚                                â”‚
    â”‚  2ï¸âƒ£ Criar registros em         â”‚
    â”‚     'sold_products'            â”‚
    â”‚     Para cada produto:         â”‚
    â”‚     - product_id               â”‚
    â”‚     - quantity                 â”‚
    â”‚     - sold_price               â”‚
    â”‚     - commission_percentage    â”‚
    â”‚                                â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â”‚ Sucesso
                 â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  âœ… VENDA REGISTRADA           â”‚
    â”‚                                â”‚
    â”‚  - Toast de confirmaÃ§Ã£o        â”‚
    â”‚  - Atualizar lista             â”‚
    â”‚  - Fechar modal                â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”„ Estados do MostruÃ¡rio

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ENTREGUE   â”‚  â† MostruÃ¡rio enviado ao distribuidor
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ Admin finaliza
       â”‚ registra devoluÃ§Ãµes
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FINALIZADO  â”‚  â† Pode registrar venda
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ Admin registra venda
       â”‚ (opcional, mÃºltiplas vezes)
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  COM VENDA  â”‚  â† Tem registro em 'sales'
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ’¾ Estrutura de Dados

```
showcase (id: 8, code: "MST-00008")
    â”œâ”€â”€ profile_id: "uuid-distribuidor"
    â”œâ”€â”€ status: "finalizado" (calculado)
    â”‚
    â”œâ”€â”€ inventory_movements (envios)
    â”‚   â”œâ”€â”€ product_id: 1, quantity: -5 (enviado 5)
    â”‚   â”œâ”€â”€ product_id: 2, quantity: -3 (enviado 3)
    â”‚   â””â”€â”€ product_id: 3, quantity: -2 (enviado 2)
    â”‚
    â”œâ”€â”€ showcase_returns (devoluÃ§Ãµes)
    â”‚   â”œâ”€â”€ product_id: 1, returned_quantity: 2
    â”‚   â””â”€â”€ product_id: 3, returned_quantity: 2
    â”‚
    â””â”€â”€ sales (vendas registradas)
        â”œâ”€â”€ id: 123
        â”œâ”€â”€ total_value: 40000
        â”‚
        â””â”€â”€ sold_products
            â”œâ”€â”€ product_id: 1, quantity: 3, commission: 15%
            â”‚   (5 enviado - 2 devolvido = 3 vendido)
            â””â”€â”€ product_id: 2, quantity: 3, commission: 15%
                (3 enviado - 0 devolvido = 3 vendido)
            
            (Produto 3 nÃ£o aparece, pois foi 100% devolvido)
```

## ğŸ¯ CÃ¡lculo de Vendas

```javascript
// Para cada produto no mostruÃ¡rio:
const sentQty = Math.abs(inventory_movement.quantity)        // Ex: 5
const returnedQty = showcase_return?.returned_quantity || 0  // Ex: 2
const soldQty = sentQty - returnedQty                        // Ex: 3

// Se soldQty > 0, produto Ã© incluÃ­do na venda
```

## ğŸ” PermissÃµes

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    ADMIN     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âœ… Criar      â”‚
â”‚ âœ… Finalizar  â”‚
â”‚ âœ… Registrar  â”‚
â”‚    Venda     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ REVENDEDOR   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âœ… Ver        â”‚
â”‚    HistÃ³rico â”‚
â”‚ âŒ Registrar  â”‚
â”‚    Venda     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“± Interface Responsiva

```
Desktop (â‰¥768px):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [Grid 3 colunas de cards]           â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”            â”‚
â”‚ â”‚Card â”‚ â”‚Card â”‚ â”‚Card â”‚            â”‚
â”‚ â”‚  1  â”‚ â”‚  2  â”‚ â”‚  3  â”‚            â”‚
â”‚ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Mobile (<768px):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [1 coluna]    â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚   Card 1  â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚   Card 2  â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚   Card 3  â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

**Legenda**:
- â”Œâ”€â” : Container/Card
- â”œâ”€â”¤ : Separador
- â””â”€â”˜ : Fim do container
- â”‚   : ConexÃ£o vertical
- â”€   : ConexÃ£o horizontal
- â–¼   : Fluxo/DireÃ§Ã£o
- [ ] : Switch/Checkbox
- [x] : Estado ativo
